---
title: "Plots"
author: "aaron till"
date: "4/19/2018"
output: html_document
---

```{r}
library(tidyverse)
library(readxl)
library(stringr)
```


# Data Import
```{r}

Affordable_Housing_10_14 <- read.csv("HAI_map_2010-14.csv")

Evictions <- read_xlsx('eviction_lab_export.xlsx')

Oregon_Housing_Prices <- read_xlsx('2017-OOR-OR.xlsx')

PIT_CoC <- read_xlsx("2007-2017-PIT-Counts-by-CoC.XLSX.xlsx")
PIT_CoC <- PIT_CoC %>%
  rename('CoC_Name' = 'CoC Name') %>%
  rename('Unsheltered' =  'Unsheltered Homeless, 2017' )


PIT_State <- read_xlsx("2007-2017-PIT-Counts-by-State.xlsx")

Helper_State_Abrvs <- read.csv("states.csv.csv")

```


# County Tidying - Fail
```{r}

Affordable_Housing_10_14 <- Affordable_Housing_10_14 %>%
  mutate(countyname2 = str_remove(countyname, pattern = ' County'))



PIT_CoC <- PIT_CoC %>%
  mutate(countyname2 = str_remove(CoC_Name, pattern = ' CoC'))  # INCORPORATED REGIONS NOT COUNTIES 


#Affordable_Counties <- merge(Affordable_Housing_10_14, PIT_CoC)



```


# State Tidying
```{r}
 
Affordable_Housing_10_14_State <- Affordable_Housing_10_14 %>%
  group_by(State_Name) %>%
  summarise(units = mean(units, na.rm = TRUE), per100 = mean(per100, na.rm = TRUE))

Intermediate_Housing_State_Abrvs <-full_join(Affordable_Housing_10_14_State, Helper_State_Abrvs, by = c('State_Name' = 'State'))

PIT_Housing_State_Merge <- inner_join(Intermediate_Housing_State_Abrvs, PIT_State, by = c('Abbreviation' = 'state')) %>%
  rename('Change_2007' = 'Change in Total Homelessness, 2007-2017') %>%
  rename('Change_2008' = 'Change in Total Homelessness, 2008-2017') %>%
  rename('Change_2009' = 'Change in Total Homelessness, 2009-2017') %>%
  rename('Change_2010' = 'Change in Total Homelessness, 2010-2017') %>%
  rename('Change_2011' = 'Change in Total Homelessness, 2011-2017') %>%
  rename('Change_2012' = 'Change in Total Homelessness, 2012-2017') %>%
  rename('Change_2013' = 'Change in Total Homelessness, 2013-2017') %>%
  rename('Change_2014' = 'Change in Total Homelessness, 2014-2017') %>%
  rename('Change_2015' = 'Change in Total Homelessness, 2015-2017') %>%
  rename('Change_2016' = 'Change in Total Homelessness, 2016-2017') 

```

```{r}



ggplot(PIT_Housing_State_Merge, aes(y = as.numeric(Change_2014), x = per100)) +
  geom_point() + 
  geom_smooth(method = 'lm')

```
